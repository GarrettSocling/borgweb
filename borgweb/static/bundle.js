/**
  This file was autogenerated.
  See https://github.com/borgbackup/borgweb
*/
(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
'use strict';

var dateformat = require('dateformat');

/**
  ~~ Config ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
*/
var cfg = {
  'logFilesList': [],
  'logFilesListHTML': '',
  'lastSelectedLog': NaN,
  'pollFrequency': 100,
  'shownLog': {
    'id': 0, 'offset': 0, 'lines': 10 },
  'transitionTime': 170
};

/**
  ~~ BorgBackup interaction ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
*/
var noBackupRunning = function noBackupRunning(callback) {
  $.getJSON('backup/status', function (resp) {
    var backupRunning = resp.rc === null;
    if (backupRunning) log('▶ Backup in progress');else log('✖ No backup in progress');
    callback(!backupRunning);
  });
};
var pollBackupStatus = function pollBackupStatus(endpoint, ms, callback) {
  noBackupRunning(function (notRunning) {
    if (notRunning) {
      $('.navbar button[type=submit]').toggleClass('btn-success');
      $('.navbar button[type=submit]').toggleClass('btn-warning');
      $('.navbar button[type=submit]').text('▶ Start Backup');
      $.getJSON('logs', updateLogFileList);
    } else {
      log('Polling backup status');
      $.getJSON('backup/status', callback);
      setTimeout(ms, pollBackupStatus(endpoint, ms, callback));
    }
  });
};
var stopBackup = function stopBackup() {
  log('Terminating (eventually killing) the backup process');
  $.post('backup/stop', {}, function (res) {
    log('Message: \'' + res.msg + '\', RC: \'' + res.rc + '\'');
  });
};
var startBackup = function startBackup(force) {
  if (force) {
    log('Sending backup start request');
    $.post('backup/start', {}, function () {
      $('.navbar button[type=submit]').toggleClass('btn-success');
      $('.navbar button[type=submit]').toggleClass('btn-warning');
      $('.navbar button[type=submit]').text('✖ Stop Backup');
      pollBackupStatus('backup/status', cfg['pollFrequency'], function (res) {
        log('Received status update');
      });
    });
  } else if (force === undefined) noBackupRunning(startBackup);else {
    stopBackup();
  }
};

/**
  ~~ Utility ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
*/
var log = function log() {
  var args = Array.prototype.slice.call(arguments);
  var time = '[' + dateformat(new Date(), 'HH:MM:ss') + ']';
  args.unshift(time);
  console.log.apply(console, args);
  return this;
};
var isInt = function isInt(n) {
  return n % 1 === 0;
};
var success = function success(data) {
  logFiles = data.log_files;
};
var parseAnchor = function parseAnchor() {
  var url = window.location.href.toString();
  var idx = url.indexOf('#');
  var anchor = idx != -1 ? url.substring(idx + 1) : '';
  if (anchor) {
    var parts = anchor.split(';');
    var partsParsed = {};
    parts.forEach(function (e) {
      var pair = e.split(':');
      partsParsed[pair[0]] = pair[1];
    });
    return partsParsed;
  } else return { 'log': 0 };
};

/**
  ~~ UI updaters ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
*/
var updateLogFileList = function updateLogFileList(logFiles) {
  log('Updating log file list');
  cfg.logFilesListHTML = [];
  $.each(logFiles.files, function (key, value) {
    cfg.logFilesListHTML += '<li><a href="#log:' + value[0] + '" onClick="window.displayThatLog(' + value[0] + ')">' + value[1] + '</a></li>';
  });
  $('#log-files').html(cfg.logFilesListHTML);
};
var appendLog = function appendLog(data) {
  log('Rendering: ' + data.fname);

  // set status icon:
  $.getJSON('logs/' + cfg['shownLog']['id'], function (res) {
    var icon = {
      'success': ['ok-circle', '#5cb85c'],
      'warning': ['ban-circle', '#f0ad4e'],
      'error': ['remove-circle', '#c9302c']
    };
    $('#log-path').html('<span class="glyphicon glyphicon-' + icon[res.status][0] + '" aria-hidden="true" style="color: ' + icon[res.status][1] + '; width: 20px; height: 24px; vertical-align: top;"></span> ' + res.filename);
  });

  // append log text:
  var logText = $('#log-text');
  if (cfg['shownLog']['offset'] === 0) $('#log-text').html('');
  data.lines.forEach(function (val, index) {
    logText.append(val[1] + '\n');
  });
  $('#loadMore').remove();
  cfg['shownLog']['offset'] = data.offset;
  logText.after('<button id="loadMore" onClick="window.showLog(' + cfg['shownLog']['id'] + ', ' + cfg['shownLog']['offset'] + ', ' + cfg['shownLog']['lines'] + ')">load more</button>');
};
var showLog = function showLog(id, offset, lines) {
  if (arguments.length === 1 || id !== cfg['shownLog']['id']) {
    log('Displaying different log than before');
    $('#log-text').fadeOut(cfg['transitionTime'] * 0.5);
    cfg['shownLog']['offset'] = 0;
  }
  cfg['shownLog']['id'] = id || cfg['shownLog']['id'];
  cfg['shownLog']['offset'] = offset || cfg['shownLog']['offset'];
  cfg['shownLog']['lines'] = lines || cfg['shownLog']['lines'];
  var url = 'logs/' + cfg['shownLog']['id'] + '/' + cfg['shownLog']['offset'] + ':' + cfg['shownLog']['lines'];
  log('Fetching log (' + cfg['shownLog']['id'] + ', ' + cfg['shownLog']['offset'] + ', ' + cfg['shownLog']['lines'] + ')');
  $.getJSON(url, appendLog);
  $('#log-text').fadeIn(cfg['transitionTime'] * 0.5);
};

/**
  ~~ UI callables ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
*/
window.displayThatLog = function (that) {
  showLog(that);
};
window.startBackup = startBackup;
window.showLog = showLog;
/**
  ~~ Site init ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
*/
$.getJSON('logs', updateLogFileList);
showLog();

},{"dateformat":2}],2:[function(require,module,exports){
/*
 * Date Format 1.2.3
 * (c) 2007-2009 Steven Levithan <stevenlevithan.com>
 * MIT license
 *
 * Includes enhancements by Scott Trenda <scott.trenda.net>
 * and Kris Kowal <cixar.com/~kris.kowal/>
 *
 * Accepts a date, a mask, or a date and a mask.
 * Returns a formatted version of the given date.
 * The date defaults to the current date/time.
 * The mask defaults to dateFormat.masks.default.
 */

(function(global) {
  'use strict';

  var dateFormat = (function() {
      var token = /d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZWN]|'[^']*'|'[^']*'/g;
      var timezone = /\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g;
      var timezoneClip = /[^-+\dA-Z]/g;
  
      // Regexes and supporting functions are cached through closure
      return function (date, mask, utc, gmt) {
  
        // You can't provide utc if you skip other args (use the 'UTC:' mask prefix)
        if (arguments.length === 1 && kindOf(date) === 'string' && !/\d/.test(date)) {
          mask = date;
          date = undefined;
        }
  
        date = date || new Date;
  
        if(!(date instanceof Date)) {
          date = new Date(date);
        }
  
        if (isNaN(date)) {
          throw TypeError('Invalid date');
        }
  
        mask = String(dateFormat.masks[mask] || mask || dateFormat.masks['default']);
  
        // Allow setting the utc/gmt argument via the mask
        var maskSlice = mask.slice(0, 4);
        if (maskSlice === 'UTC:' || maskSlice === 'GMT:') {
          mask = mask.slice(4);
          utc = true;
          if (maskSlice === 'GMT:') {
            gmt = true;
          }
        }
  
        var _ = utc ? 'getUTC' : 'get';
        var d = date[_ + 'Date']();
        var D = date[_ + 'Day']();
        var m = date[_ + 'Month']();
        var y = date[_ + 'FullYear']();
        var H = date[_ + 'Hours']();
        var M = date[_ + 'Minutes']();
        var s = date[_ + 'Seconds']();
        var L = date[_ + 'Milliseconds']();
        var o = utc ? 0 : date.getTimezoneOffset();
        var W = getWeek(date);
        var N = getDayOfWeek(date);
        var flags = {
          d:    d,
          dd:   pad(d),
          ddd:  dateFormat.i18n.dayNames[D],
          dddd: dateFormat.i18n.dayNames[D + 7],
          m:    m + 1,
          mm:   pad(m + 1),
          mmm:  dateFormat.i18n.monthNames[m],
          mmmm: dateFormat.i18n.monthNames[m + 12],
          yy:   String(y).slice(2),
          yyyy: y,
          h:    H % 12 || 12,
          hh:   pad(H % 12 || 12),
          H:    H,
          HH:   pad(H),
          M:    M,
          MM:   pad(M),
          s:    s,
          ss:   pad(s),
          l:    pad(L, 3),
          L:    pad(Math.round(L / 10)),
          t:    H < 12 ? 'a'  : 'p',
          tt:   H < 12 ? 'am' : 'pm',
          T:    H < 12 ? 'A'  : 'P',
          TT:   H < 12 ? 'AM' : 'PM',
          Z:    gmt ? 'GMT' : utc ? 'UTC' : (String(date).match(timezone) || ['']).pop().replace(timezoneClip, ''),
          o:    (o > 0 ? '-' : '+') + pad(Math.floor(Math.abs(o) / 60) * 100 + Math.abs(o) % 60, 4),
          S:    ['th', 'st', 'nd', 'rd'][d % 10 > 3 ? 0 : (d % 100 - d % 10 != 10) * d % 10],
          W:    W,
          N:    N
        };
  
        return mask.replace(token, function (match) {
          if (match in flags) {
            return flags[match];
          }
          return match.slice(1, match.length - 1);
        });
      };
    })();

  dateFormat.masks = {
    'default':               'ddd mmm dd yyyy HH:MM:ss',
    'shortDate':             'm/d/yy',
    'mediumDate':            'mmm d, yyyy',
    'longDate':              'mmmm d, yyyy',
    'fullDate':              'dddd, mmmm d, yyyy',
    'shortTime':             'h:MM TT',
    'mediumTime':            'h:MM:ss TT',
    'longTime':              'h:MM:ss TT Z',
    'isoDate':               'yyyy-mm-dd',
    'isoTime':               'HH:MM:ss',
    'isoDateTime':           'yyyy-mm-dd\'T\'HH:MM:sso',
    'isoUtcDateTime':        'UTC:yyyy-mm-dd\'T\'HH:MM:ss\'Z\'',
    'expiresHeaderFormat':   'ddd, dd mmm yyyy HH:MM:ss Z'
  };

  // Internationalization strings
  dateFormat.i18n = {
    dayNames: [
      'Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat',
      'Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'
    ],
    monthNames: [
      'Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec',
      'January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'
    ]
  };

function pad(val, len) {
  val = String(val);
  len = len || 2;
  while (val.length < len) {
    val = '0' + val;
  }
  return val;
}

/**
 * Get the ISO 8601 week number
 * Based on comments from
 * http://techblog.procurios.nl/k/n618/news/view/33796/14863/Calculate-ISO-8601-week-and-year-in-javascript.html
 *
 * @param  {Object} `date`
 * @return {Number}
 */
function getWeek(date) {
  // Remove time components of date
  var targetThursday = new Date(date.getFullYear(), date.getMonth(), date.getDate());

  // Change date to Thursday same week
  targetThursday.setDate(targetThursday.getDate() - ((targetThursday.getDay() + 6) % 7) + 3);

  // Take January 4th as it is always in week 1 (see ISO 8601)
  var firstThursday = new Date(targetThursday.getFullYear(), 0, 4);

  // Change date to Thursday same week
  firstThursday.setDate(firstThursday.getDate() - ((firstThursday.getDay() + 6) % 7) + 3);

  // Check if daylight-saving-time-switch occured and correct for it
  var ds = targetThursday.getTimezoneOffset() - firstThursday.getTimezoneOffset();
  targetThursday.setHours(targetThursday.getHours() - ds);

  // Number of weeks between target Thursday and first Thursday
  var weekDiff = (targetThursday - firstThursday) / (86400000*7);
  return 1 + Math.floor(weekDiff);
}

/**
 * Get ISO-8601 numeric representation of the day of the week
 * 1 (for Monday) through 7 (for Sunday)
 * 
 * @param  {Object} `date`
 * @return {Number}
 */
function getDayOfWeek(date) {
  var dow = date.getDay();
  if(dow === 0) {
    dow = 7;
  }
  return dow;
}

/**
 * kind-of shortcut
 * @param  {*} val
 * @return {String}
 */
function kindOf(val) {
  if (val === null) {
    return 'null';
  }

  if (val === undefined) {
    return 'undefined';
  }

  if (typeof val !== 'object') {
    return typeof val;
  }

  if (Array.isArray(val)) {
    return 'array';
  }

  return {}.toString.call(val)
    .slice(8, -1).toLowerCase();
};



  if (typeof define === 'function' && define.amd) {
    define(dateFormat);
  } else if (typeof exports === 'object') {
    module.exports = dateFormat;
  } else {
    global.dateFormat = dateFormat;
  }
})(this);

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCIvaG9tZS9wZ3V0aC9naXRodWIvYm9yZ3dlYi9qcy9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy9kYXRlZm9ybWF0L2xpYi9kYXRlZm9ybWF0LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7QUNBQSxJQUFJLFVBQVUsR0FBRyxPQUFPLENBQUMsWUFBWSxDQUFDLENBQUE7Ozs7O0FBS3RDLElBQUksR0FBRyxHQUFHO0FBQ1IsZ0JBQWMsRUFBRSxFQUFFO0FBQ2xCLG9CQUFrQixFQUFFLEVBQUU7QUFDdEIsbUJBQWlCLEVBQUUsR0FBRztBQUN0QixpQkFBZSxFQUFFLEdBQUc7QUFDcEIsWUFBVSxFQUFFO0FBQ1YsUUFBSSxFQUFFLENBQUMsRUFBRSxRQUFRLEVBQUUsQ0FBQyxFQUFFLE9BQU8sRUFBRSxFQUFFLEVBQUU7QUFDckMsa0JBQWdCLEVBQUUsR0FBRztDQUN0QixDQUFBOzs7OztBQUtELElBQUksZUFBZSxHQUFHLFNBQWxCLGVBQWUsQ0FBYSxRQUFRLEVBQUU7QUFDeEMsR0FBQyxDQUFDLE9BQU8sQ0FBQyxlQUFlLEVBQUUsVUFBVSxJQUFJLEVBQUU7QUFDekMsUUFBSSxhQUFhLEdBQUcsSUFBSSxDQUFDLEVBQUUsS0FBSyxJQUFJLENBQUE7QUFDcEMsUUFBSSxhQUFhLEVBQUUsR0FBRyxDQUFDLHNCQUFzQixDQUFDLENBQUEsS0FDekMsR0FBRyxDQUFDLHlCQUF5QixDQUFDLENBQUE7QUFDbkMsWUFBUSxDQUFDLENBQUMsYUFBYSxDQUFDLENBQUE7R0FDekIsQ0FBQyxDQUFBO0NBQ0gsQ0FBQTtBQUNELElBQUksZ0JBQWdCLEdBQUcsU0FBbkIsZ0JBQWdCLENBQWEsUUFBUSxFQUFFLEVBQUUsRUFBRSxRQUFRLEVBQUU7QUFDdkQsaUJBQWUsQ0FBQyxVQUFVLFVBQVUsRUFBRTtBQUNwQyxRQUFJLFVBQVUsRUFBRTtBQUNk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Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCJ2YXIgZGF0ZWZvcm1hdCA9IHJlcXVpcmUoJ2RhdGVmb3JtYXQnKVxuXG4vKipcbiAgfn4gQ29uZmlnIH5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+XG4qL1xudmFyIGNmZyA9IHtcbiAgJ2xvZ0ZpbGVzTGlzdCc6IFtdLFxuICAnbG9nRmlsZXNMaXN0SFRNTCc6IFwiXCIsXG4gICdsYXN0U2VsZWN0ZWRMb2cnOiBOYU4sXG4gICdwb2xsRnJlcXVlbmN5JzogMTAwLFxuICAnc2hvd25Mb2cnOiB7XG4gICAgJ2lkJzogMCwgJ29mZnNldCc6IDAsICdsaW5lcyc6IDEwIH0sXG4gICd0cmFuc2l0aW9uVGltZSc6IDE3MFxufVxuXG4vKipcbiAgfn4gQm9yZ0JhY2t1cCBpbnRlcmFjdGlvbiB+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+XG4qL1xudmFyIG5vQmFja3VwUnVubmluZyA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAkLmdldEpTT04oJ2JhY2t1cC9zdGF0dXMnLCBmdW5jdGlvbiAocmVzcCkge1xuICAgIHZhciBiYWNrdXBSdW5uaW5nID0gcmVzcC5yYyA9PT0gbnVsbFxuICAgIGlmIChiYWNrdXBSdW5uaW5nKSBsb2coXCLilrYgQmFja3VwIGluIHByb2dyZXNzXCIpXG4gICAgZWxzZSBsb2coXCLinJYgTm8gYmFja3VwIGluIHByb2dyZXNzXCIpXG4gICAgY2FsbGJhY2soIWJhY2t1cFJ1bm5pbmcpXG4gIH0pXG59XG52YXIgcG9sbEJhY2t1cFN0YXR1cyA9IGZ1bmN0aW9uIChlbmRwb2ludCwgbXMsIGNhbGxiYWNrKSB7XG4gIG5vQmFja3VwUnVubmluZyhmdW5jdGlvbiAobm90UnVubmluZykge1xuICAgIGlmIChub3RSdW5uaW5nKSB7XG4gICAgICAkKCcubmF2YmFyIGJ1dHRvblt0eXBlPXN1Ym1pdF0nKS50b2dnbGVDbGFzcygnYnRuLXN1Y2Nlc3MnKVxuICAgICAgJCgnLm5hdmJhciBidXR0b25bdHlwZT1zdWJtaXRdJykudG9nZ2xlQ2xhc3MoJ2J0bi13YXJuaW5nJylcbiAgICAgICQoJy5uYXZiYXIgYnV0dG9uW3R5cGU9c3VibWl0XScpLnRleHQoXCLilrYgU3RhcnQgQmFja3VwXCIpXG4gICAgICAkLmdldEpTT04oJ2xvZ3MnLCB1cGRhdGVMb2dGaWxlTGlzdClcbiAgICB9IGVsc2Uge1xuICAgICAgbG9nKFwiUG9sbGluZyBiYWNrdXAgc3RhdHVzXCIpXG4gICAgICAkLmdldEpTT04oJ2JhY2t1cC9zdGF0dXMnLCBjYWxsYmFjaylcbiAgICAgIHNldFRpbWVvdXQobXMsIHBvbGxCYWNrdXBTdGF0dXMoZW5kcG9pbnQsIG1zLCBjYWxsYmFjaykpXG4gICAgfVxuICB9KVxufVxudmFyIHN0b3BCYWNrdXAgPSBmdW5jdGlvbiAoKSB7XG4gIGxvZyhcIlRlcm1pbmF0aW5nIChldmVudHVhbGx5IGtpbGxpbmcpIHRoZSBiYWNrdXAgcHJvY2Vzc1wiKVxuICAkLnBvc3QoJ2JhY2t1cC9zdG9wJywge30sIGZ1bmN0aW9uIChyZXMpIHtcbiAgICBsb2coXCJNZXNzYWdlOiAnXCIgKyByZXMubXNnICsgXCInLCBSQzogJ1wiICsgcmVzLnJjICsgXCInXCIpIH0pXG59XG52YXIgc3RhcnRCYWNrdXAgPSBmdW5jdGlvbiAoZm9yY2UpIHtcbiAgaWYgKGZvcmNlKSB7XG4gICAgbG9nKFwiU2VuZGluZyBiYWNrdXAgc3RhcnQgcmVxdWVzdFwiKVxuICAgICQucG9zdCgnYmFja3VwL3N0YXJ0Jywge30sIGZ1bmN0aW9uICgpIHtcbiAgICAgICQoJy5uYXZiYXIgYnV0dG9uW3R5cGU9c3VibWl0XScpLnRvZ2dsZUNsYXNzKCdidG4tc3VjY2VzcycpXG4gICAgICAkKCcubmF2YmFyIGJ1dHRvblt0eXBlPXN1Ym1pdF0nKS50b2dnbGVDbGFzcygnYnRuLXdhcm5pbmcnKVxuICAgICAgJCgnLm5hdmJhciBidXR0b25bdHlwZT1zdWJtaXRdJykudGV4dChcIuKcliBTdG9wIEJhY2t1cFwiKVxuICAgICAgcG9sbEJhY2t1cFN0YXR1cygnYmFja3VwL3N0YXR1cycsIGNmZ1sncG9sbEZyZXF1ZW5jeSddLFxuICAgICAgICBmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgICAgbG9nKFwiUmVjZWl2ZWQgc3RhdHVzIHVwZGF0ZVwiKVxuICAgICAgICB9KSB9KVxuICB9IGVsc2UgaWYgKGZvcmNlID09PSB1bmRlZmluZWQpIG5vQmFja3VwUnVubmluZyhzdGFydEJhY2t1cClcbiAgICBlbHNlIHtcbiAgICBzdG9wQmFja3VwKClcbiAgfVxufVxuXG4vKipcbiAgfn4gVXRpbGl0eSB+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+XG4qL1xudmFyIGxvZyA9IGZ1bmN0aW9uKCl7XG4gIHZhciBhcmdzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzKVxuICB2YXIgdGltZSA9ICdbJyArIGRhdGVmb3JtYXQobmV3IERhdGUoKSwgJ0hIOk1NOnNzJykgKyAnXSdcbiAgYXJncy51bnNoaWZ0KHRpbWUpXG4gIGNvbnNvbGUubG9nLmFwcGx5KGNvbnNvbGUsIGFyZ3MpO1xuICByZXR1cm4gdGhpc1xufVxudmFyIGlzSW50ID0gZnVuY3Rpb24gKG4pIHtcbiAgcmV0dXJuIG4gJSAxID09PSAwXG59XG52YXIgc3VjY2VzcyA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gIGxvZ0ZpbGVzID0gZGF0YS5sb2dfZmlsZXNcbn1cbnZhciBwYXJzZUFuY2hvciA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIHVybCA9IHdpbmRvdy5sb2NhdGlvbi5ocmVmLnRvU3RyaW5nKClcbiAgdmFyIGlkeCA9IHVybC5pbmRleE9mKFwiI1wiKVxuICB2YXIgYW5jaG9yID0gKGlkeCAhPSAtMSkgPyB1cmwuc3Vic3RyaW5nKGlkeCsxKSA6IFwiXCJcbiAgaWYgKGFuY2hvcikge1xuICAgIHZhciBwYXJ0cyA9IGFuY2hvci5zcGxpdCgnOycpXG4gICAgdmFyIHBhcnRzUGFyc2VkID0ge31cbiAgICBwYXJ0cy5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7XG4gICAgICB2YXIgcGFpciA9IGUuc3BsaXQoJzonKVxuICAgICAgcGFydHNQYXJzZWRbcGFpclswXV0gPSBwYWlyWzFdXG4gICAgfSlcbiAgICByZXR1cm4gcGFydHNQYXJzZWRcbiAgfSBlbHNlIHJldHVybiB7J2xvZyc6IDB9XG59XG5cbi8qKlxuICB+fiBVSSB1cGRhdGVycyB+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5cbiovXG52YXIgdXBkYXRlTG9nRmlsZUxpc3QgPSBmdW5jdGlvbiAobG9nRmlsZXMpIHtcbiAgbG9nKFwiVXBkYXRpbmcgbG9nIGZpbGUgbGlzdFwiKVxuICBjZmcubG9nRmlsZXNMaXN0SFRNTCA9IFtdXG4gICQuZWFjaChsb2dGaWxlcy5maWxlcywgZnVuY3Rpb24gKGtleSwgdmFsdWUpIHtcbiAgICBjZmcubG9nRmlsZXNMaXN0SFRNTCArPSAnPGxpPjxhIGhyZWY9XCIjbG9nOicgKyB2YWx1ZVswXVxuICAgICAgKyAnXCIgb25DbGljaz1cIndpbmRvdy5kaXNwbGF5VGhhdExvZygnXG4gICAgICArIHZhbHVlWzBdICsgJylcIj4nICsgdmFsdWVbMV0gKyAnPC9hPjwvbGk+J30pXG4gICQoJyNsb2ctZmlsZXMnKS5odG1sKGNmZy5sb2dGaWxlc0xpc3RIVE1MKVxufVxudmFyIGFwcGVuZExvZyA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gIGxvZyhcIlJlbmRlcmluZzogXCIgKyBkYXRhLmZuYW1lKVxuICBcbiAgLy8gc2V0IHN0YXR1cyBpY29uOlxuICAkLmdldEpTT04oJ2xvZ3MvJyArIGNmZ1snc2hvd25Mb2cnXVsnaWQnXSwgZnVuY3Rpb24gKHJlcykge1xuICAgIHZhciBpY29uID0ge1xuICAgICAgJ3N1Y2Nlc3MnOiBbJ29rLWNpcmNsZScsICcjNWNiODVjJ10sXG4gICAgICAnd2FybmluZyc6IFsnYmFuLWNpcmNsZScsICcjZjBhZDRlJ10sXG4gICAgICAnZXJyb3InOiBbJ3JlbW92ZS1jaXJjbGUnLCAnI2M5MzAyYyddXG4gICAgfVxuICAgICQoJyNsb2ctcGF0aCcpLmh0bWwoJzxzcGFuIGNsYXNzPVwiZ2x5cGhpY29uIGdseXBoaWNvbi0nICsgaWNvbltyZXMuc3RhdHVzXVswXVxuICAgICAgKyAnXCIgYXJpYS1oaWRkZW49XCJ0cnVlXCIgc3R5bGU9XCJjb2xvcjogJyArIGljb25bcmVzLnN0YXR1c11bMV1cbiAgICAgICsgJzsgd2lkdGg6IDIwcHg7IGhlaWdodDogMjRweDsgdmVydGljYWwtYWxpZ246IHRvcDtcIj48L3NwYW4+ICcgKyByZXMuZmlsZW5hbWUgKVxuICB9KVxuICBcbiAgLy8gYXBwZW5kIGxvZyB0ZXh0OlxuICB2YXIgbG9nVGV4dCA9ICQoJyNsb2ctdGV4dCcpXG4gIGlmIChjZmdbJ3Nob3duTG9nJ11bJ29mZnNldCddID09PSAwKSAkKCcjbG9nLXRleHQnKS5odG1sKCcnKVxuICBkYXRhLmxpbmVzLmZvckVhY2goZnVuY3Rpb24gKHZhbCwgaW5kZXgpIHsgbG9nVGV4dC5hcHBlbmQodmFsWzFdICsgJ1xcbicpIH0pXG4gICQoJyNsb2FkTW9yZScpLnJlbW92ZSgpXG4gIGNmZ1snc2hvd25Mb2cnXVsnb2Zmc2V0J10gPSBkYXRhLm9mZnNldFxuICBsb2dUZXh0LmFmdGVyKCc8YnV0dG9uIGlkPVwibG9hZE1vcmVcIiBvbkNsaWNrPVwid2luZG93LnNob3dMb2coJ1xuICAgICsgY2ZnWydzaG93bkxvZyddWydpZCddICsgJywgJyArIGNmZ1snc2hvd25Mb2cnXVsnb2Zmc2V0J10gKyAnLCAnXG4gICAgKyBjZmdbJ3Nob3duTG9nJ11bJ2xpbmVzJ10gKyAnKVwiPmxvYWQgbW9yZTwvYnV0dG9uPicgKVxufVxudmFyIHNob3dMb2cgPSBmdW5jdGlvbiAoaWQsIG9mZnNldCwgbGluZXMpIHtcbiAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDEgfHwgaWQgIT09IGNmZ1snc2hvd25Mb2cnXVsnaWQnXSkge1xuICAgIGxvZyhcIkRpc3BsYXlpbmcgZGlmZmVyZW50IGxvZyB0aGFuIGJlZm9yZVwiKVxuICAgICQoJyNsb2ctdGV4dCcpLmZhZGVPdXQoY2ZnWyd0cmFuc2l0aW9uVGltZSddICogMC41KVxuICAgIGNmZ1snc2hvd25Mb2cnXVsnb2Zmc2V0J10gPSAwIH1cbiAgY2ZnWydzaG93bkxvZyddWydpZCddID0gaWQgfHwgY2ZnWydzaG93bkxvZyddWydpZCddXG4gIGNmZ1snc2hvd25Mb2cnXVsnb2Zmc2V0J10gPSBvZmZzZXQgfHwgY2ZnWydzaG93bkxvZyddWydvZmZzZXQnXVxuICBjZmdbJ3Nob3duTG9nJ11bJ2xpbmVzJ10gPSBsaW5lcyB8fCBjZmdbJ3Nob3duTG9nJ11bJ2xpbmVzJ11cbiAgdmFyIHVybCA9ICdsb2dzLycgKyBjZmdbJ3Nob3duTG9nJ11bJ2lkJ10gKyAnLycgKyBjZmdbJ3Nob3duTG9nJ11bJ29mZnNldCddXG4gICAgKyAnOicgKyBjZmdbJ3Nob3duTG9nJ11bJ2xpbmVzJ11cbiAgbG9nKFwiRmV0Y2hpbmcgbG9nIChcIiArIGNmZ1snc2hvd25Mb2cnXVsnaWQnXSArICcsICdcbiAgICArIGNmZ1snc2hvd25Mb2cnXVsnb2Zmc2V0J10gKyAnLCAnICsgY2ZnWydzaG93bkxvZyddWydsaW5lcyddICsgJyknKVxuICAkLmdldEpTT04odXJsLCBhcHBlbmRMb2cpXG4gICQoJyNsb2ctdGV4dCcpLmZhZGVJbihjZmdbJ3RyYW5zaXRpb25UaW1lJ10gKiAwLjUpXG59XG5cbi8qKlxuICB+fiBVSSBjYWxsYWJsZXMgfn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5cbiovXG53aW5kb3cuZGlzcGxheVRoYXRMb2cgPSBmdW5jdGlvbiAodGhhdCkge1xuICBzaG93TG9nKHRoYXQpXG59XG53aW5kb3cuc3RhcnRCYWNrdXAgPSBzdGFydEJhY2t1cFxud2luZG93LnNob3dMb2cgPSBzaG93TG9nXG4vKipcbiAgfn4gU2l0ZSBpbml0IH5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+XG4qL1xuJC5nZXRKU09OKCdsb2dzJywgdXBkYXRlTG9nRmlsZUxpc3QpXG5zaG93TG9nKClcblxuXG5cblxuXG5cbiIsIi8qXG4gKiBEYXRlIEZvcm1hdCAxLjIuM1xuICogKGMpIDIwMDctMjAwOSBTdGV2ZW4gTGV2aXRoYW4gPHN0ZXZlbmxldml0aGFuLmNvbT5cbiAqIE1JVCBsaWNlbnNlXG4gKlxuICogSW5jbHVkZXMgZW5oYW5jZW1lbnRzIGJ5IFNjb3R0IFRyZW5kYSA8c2NvdHQudHJlbmRhLm5ldD5cbiAqIGFuZCBLcmlzIEtvd2FsIDxjaXhhci5jb20vfmtyaXMua293YWwvPlxuICpcbiAqIEFjY2VwdHMgYSBkYXRlLCBhIG1hc2ssIG9yIGEgZGF0ZSBhbmQgYSBtYXNrLlxuICogUmV0dXJucyBhIGZvcm1hdHRlZCB2ZXJzaW9uIG9mIHRoZSBnaXZlbiBkYXRlLlxuICogVGhlIGRhdGUgZGVmYXVsdHMgdG8gdGhlIGN1cnJlbnQgZGF0ZS90aW1lLlxuICogVGhlIG1hc2sgZGVmYXVsdHMgdG8gZGF0ZUZvcm1hdC5tYXNrcy5kZWZhdWx0LlxuICovXG5cbihmdW5jdGlvbihnbG9iYWwpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIHZhciBkYXRlRm9ybWF0ID0gKGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHRva2VuID0gL2R7MSw0fXxtezEsNH18eXkoPzp5eSk/fChbSGhNc1R0XSlcXDE/fFtMbG9TWldOXXwnW14nXSonfCdbXiddKicvZztcbiAgICAgIHZhciB0aW1lem9uZSA9IC9cXGIoPzpbUE1DRUFdW1NEUF1UfCg/OlBhY2lmaWN8TW91bnRhaW58Q2VudHJhbHxFYXN0ZXJufEF0bGFudGljKSAoPzpTdGFuZGFyZHxEYXlsaWdodHxQcmV2YWlsaW5nKSBUaW1lfCg/OkdNVHxVVEMpKD86Wy0rXVxcZHs0fSk/KVxcYi9nO1xuICAgICAgdmFyIHRpbWV6b25lQ2xpcCA9IC9bXi0rXFxkQS1aXS9nO1xuICBcbiAgICAgIC8vIFJlZ2V4ZXMgYW5kIHN1cHBvcnRpbmcgZnVuY3Rpb25zIGFyZSBjYWNoZWQgdGhyb3VnaCBjbG9zdXJlXG4gICAgICByZXR1cm4gZnVuY3Rpb24gKGRhdGUsIG1hc2ssIHV0YywgZ210KSB7XG4gIFxuICAgICAgICAvLyBZb3UgY2FuJ3QgcHJvdmlkZSB1dGMgaWYgeW91IHNraXAgb3RoZXIgYXJncyAodXNlIHRoZSAnVVRDOicgbWFzayBwcmVmaXgpXG4gICAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAxICYmIGtpbmRPZihkYXRlKSA9PT0gJ3N0cmluZycgJiYgIS9cXGQvLnRlc3QoZGF0ZSkpIHtcbiAgICAgICAgICBtYXNrID0gZGF0ZTtcbiAgICAgICAgICBkYXRlID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gIFxuICAgICAgICBkYXRlID0gZGF0ZSB8fCBuZXcgRGF0ZTtcbiAgXG4gICAgICAgIGlmKCEoZGF0ZSBpbnN0YW5jZW9mIERhdGUpKSB7XG4gICAgICAgICAgZGF0ZSA9IG5ldyBEYXRlKGRhdGUpO1xuICAgICAgICB9XG4gIFxuICAgICAgICBpZiAoaXNOYU4oZGF0ZSkpIHtcbiAgICAgICAgICB0aHJvdyBUeXBlRXJyb3IoJ0ludmFsaWQgZGF0ZScpO1xuICAgICAgICB9XG4gIFxuICAgICAgICBtYXNrID0gU3RyaW5nKGRhdGVGb3JtYXQubWFza3NbbWFza10gfHwgbWFzayB8fCBkYXRlRm9ybWF0Lm1hc2tzWydkZWZhdWx0J10pO1xuICBcbiAgICAgICAgLy8gQWxsb3cgc2V0dGluZyB0aGUgdXRjL2dtdCBhcmd1bWVudCB2aWEgdGhlIG1hc2tcbiAgICAgICAgdmFyIG1hc2tTbGljZSA9IG1hc2suc2xpY2UoMCwgNCk7XG4gICAgICAgIGlmIChtYXNrU2xpY2UgPT09ICdVVEM6JyB8fCBtYXNrU2xpY2UgPT09ICdHTVQ6Jykge1xuICAgICAgICAgIG1hc2sgPSBtYXNrLnNsaWNlKDQpO1xuICAgICAgICAgIHV0YyA9IHRydWU7XG4gICAgICAgICAgaWYgKG1hc2tTbGljZSA9PT0gJ0dNVDonKSB7XG4gICAgICAgICAgICBnbXQgPSB0cnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICBcbiAgICAgICAgdmFyIF8gPSB1dGMgPyAnZ2V0VVRDJyA6ICdnZXQnO1xuICAgICAgICB2YXIgZCA9IGRhdGVbXyArICdEYXRlJ10oKTtcbiAgICAgICAgdmFyIEQgPSBkYXRlW18gKyAnRGF5J10oKTtcbiAgICAgICAgdmFyIG0gPSBkYXRlW18gKyAnTW9udGgnXSgpO1xuICAgICAgICB2YXIgeSA9IGRhdGVbXyArICdGdWxsWWVhciddKCk7XG4gICAgICAgIHZhciBIID0gZGF0ZVtfICsgJ0hvdXJzJ10oKTtcbiAgICAgICAgdmFyIE0gPSBkYXRlW18gKyAnTWludXRlcyddKCk7XG4gICAgICAgIHZhciBzID0gZGF0ZVtfICsgJ1NlY29uZHMnXSgpO1xuICAgICAgICB2YXIgTCA9IGRhdGVbXyArICdNaWxsaXNlY29uZHMnXSgpO1xuICAgICAgICB2YXIgbyA9IHV0YyA/IDAgOiBkYXRlLmdldFRpbWV6b25lT2Zmc2V0KCk7XG4gICAgICAgIHZhciBXID0gZ2V0V2VlayhkYXRlKTtcbiAgICAgICAgdmFyIE4gPSBnZXREYXlPZldlZWsoZGF0ZSk7XG4gICAgICAgIHZhciBmbGFncyA9IHtcbiAgICAgICAgICBkOiAgICBkLFxuICAgICAgICAgIGRkOiAgIHBhZChkKSxcbiAgICAgICAgICBkZGQ6ICBkYXRlRm9ybWF0LmkxOG4uZGF5TmFtZXNbRF0sXG4gICAgICAgICAgZGRkZDogZGF0ZUZvcm1hdC5pMThuLmRheU5hbWVzW0QgKyA3XSxcbiAgICAgICAgICBtOiAgICBtICsgMSxcbiAgICAgICAgICBtbTogICBwYWQobSArIDEpLFxuICAgICAgICAgIG1tbTogIGRhdGVGb3JtYXQuaTE4bi5tb250aE5hbWVzW21dLFxuICAgICAgICAgIG1tbW06IGRhdGVGb3JtYXQuaTE4bi5tb250aE5hbWVzW20gKyAxMl0sXG4gICAgICAgICAgeXk6ICAgU3RyaW5nKHkpLnNsaWNlKDIpLFxuICAgICAgICAgIHl5eXk6IHksXG4gICAgICAgICAgaDogICAgSCAlIDEyIHx8IDEyLFxuICAgICAgICAgIGhoOiAgIHBhZChIICUgMTIgfHwgMTIpLFxuICAgICAgICAgIEg6ICAgIEgsXG4gICAgICAgICAgSEg6ICAgcGFkKEgpLFxuICAgICAgICAgIE06ICAgIE0sXG4gICAgICAgICAgTU06ICAgcGFkKE0pLFxuICAgICAgICAgIHM6ICAgIHMsXG4gICAgICAgICAgc3M6ICAgcGFkKHMpLFxuICAgICAgICAgIGw6ICAgIHBhZChMLCAzKSxcbiAgICAgICAgICBMOiAgICBwYWQoTWF0aC5yb3VuZChMIC8gMTApKSxcbiAgICAgICAgICB0OiAgICBIIDwgMTIgPyAnYScgIDogJ3AnLFxuICAgICAgICAgIHR0OiAgIEggPCAxMiA/ICdhbScgOiAncG0nLFxuICAgICAgICAgIFQ6ICAgIEggPCAxMiA/ICdBJyAgOiAnUCcsXG4gICAgICAgICAgVFQ6ICAgSCA8IDEyID8gJ0FNJyA6ICdQTScsXG4gICAgICAgICAgWjogICAgZ210ID8gJ0dNVCcgOiB1dGMgPyAnVVRDJyA6IChTdHJpbmcoZGF0ZSkubWF0Y2godGltZXpvbmUpIHx8IFsnJ10pLnBvcCgpLnJlcGxhY2UodGltZXpvbmVDbGlwLCAnJyksXG4gICAgICAgICAgbzogICAgKG8gPiAwID8gJy0nIDogJysnKSArIHBhZChNYXRoLmZsb29yKE1hdGguYWJzKG8pIC8gNjApICogMTAwICsgTWF0aC5hYnMobykgJSA2MCwgNCksXG4gICAgICAgICAgUzogICAgWyd0aCcsICdzdCcsICduZCcsICdyZCddW2QgJSAxMCA+IDMgPyAwIDogKGQgJSAxMDAgLSBkICUgMTAgIT0gMTApICogZCAlIDEwXSxcbiAgICAgICAgICBXOiAgICBXLFxuICAgICAgICAgIE46ICAgIE5cbiAgICAgICAgfTtcbiAgXG4gICAgICAgIHJldHVybiBtYXNrLnJlcGxhY2UodG9rZW4sIGZ1bmN0aW9uIChtYXRjaCkge1xuICAgICAgICAgIGlmIChtYXRjaCBpbiBmbGFncykge1xuICAgICAgICAgICAgcmV0dXJuIGZsYWdzW21hdGNoXTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIG1hdGNoLnNsaWNlKDEsIG1hdGNoLmxlbmd0aCAtIDEpO1xuICAgICAgICB9KTtcbiAgICAgIH07XG4gICAgfSkoKTtcblxuICBkYXRlRm9ybWF0Lm1hc2tzID0ge1xuICAgICdkZWZhdWx0JzogICAgICAgICAgICAgICAnZGRkIG1tbSBkZCB5eXl5IEhIOk1NOnNzJyxcbiAgICAnc2hvcnREYXRlJzogICAgICAgICAgICAgJ20vZC95eScsXG4gICAgJ21lZGl1bURhdGUnOiAgICAgICAgICAgICdtbW0gZCwgeXl5eScsXG4gICAgJ2xvbmdEYXRlJzogICAgICAgICAgICAgICdtbW1tIGQsIHl5eXknLFxuICAgICdmdWxsRGF0ZSc6ICAgICAgICAgICAgICAnZGRkZCwgbW1tbSBkLCB5eXl5JyxcbiAgICAnc2hvcnRUaW1lJzogICAgICAgICAgICAgJ2g6TU0gVFQnLFxuICAgICdtZWRpdW1UaW1lJzogICAgICAgICAgICAnaDpNTTpzcyBUVCcsXG4gICAgJ2xvbmdUaW1lJzogICAgICAgICAgICAgICdoOk1NOnNzIFRUIFonLFxuICAgICdpc29EYXRlJzogICAgICAgICAgICAgICAneXl5eS1tbS1kZCcsXG4gICAgJ2lzb1RpbWUnOiAgICAgICAgICAgICAgICdISDpNTTpzcycsXG4gICAgJ2lzb0RhdGVUaW1lJzogICAgICAgICAgICd5eXl5LW1tLWRkXFwnVFxcJ0hIOk1NOnNzbycsXG4gICAgJ2lzb1V0Y0RhdGVUaW1lJzogICAgICAgICdVVEM6eXl5eS1tbS1kZFxcJ1RcXCdISDpNTTpzc1xcJ1pcXCcnLFxuICAgICdleHBpcmVzSGVhZGVyRm9ybWF0JzogICAnZGRkLCBkZCBtbW0geXl5eSBISDpNTTpzcyBaJ1xuICB9O1xuXG4gIC8vIEludGVybmF0aW9uYWxpemF0aW9uIHN0cmluZ3NcbiAgZGF0ZUZvcm1hdC5pMThuID0ge1xuICAgIGRheU5hbWVzOiBbXG4gICAgICAnU3VuJywgJ01vbicsICdUdWUnLCAnV2VkJywgJ1RodScsICdGcmknLCAnU2F0JyxcbiAgICAgICdTdW5kYXknLCAnTW9uZGF5JywgJ1R1ZXNkYXknLCAnV2VkbmVzZGF5JywgJ1RodXJzZGF5JywgJ0ZyaWRheScsICdTYXR1cmRheSdcbiAgICBdLFxuICAgIG1vbnRoTmFtZXM6IFtcbiAgICAgICdKYW4nLCAnRmViJywgJ01hcicsICdBcHInLCAnTWF5JywgJ0p1bicsICdKdWwnLCAnQXVnJywgJ1NlcCcsICdPY3QnLCAnTm92JywgJ0RlYycsXG4gICAgICAnSmFudWFyeScsICdGZWJydWFyeScsICdNYXJjaCcsICdBcHJpbCcsICdNYXknLCAnSnVuZScsICdKdWx5JywgJ0F1Z3VzdCcsICdTZXB0ZW1iZXInLCAnT2N0b2JlcicsICdOb3ZlbWJlcicsICdEZWNlbWJlcidcbiAgICBdXG4gIH07XG5cbmZ1bmN0aW9uIHBhZCh2YWwsIGxlbikge1xuICB2YWwgPSBTdHJpbmcodmFsKTtcbiAgbGVuID0gbGVuIHx8IDI7XG4gIHdoaWxlICh2YWwubGVuZ3RoIDwgbGVuKSB7XG4gICAgdmFsID0gJzAnICsgdmFsO1xuICB9XG4gIHJldHVybiB2YWw7XG59XG5cbi8qKlxuICogR2V0IHRoZSBJU08gODYwMSB3ZWVrIG51bWJlclxuICogQmFzZWQgb24gY29tbWVudHMgZnJvbVxuICogaHR0cDovL3RlY2hibG9nLnByb2N1cmlvcy5ubC9rL242MTgvbmV3cy92aWV3LzMzNzk2LzE0ODYzL0NhbGN1bGF0ZS1JU08tODYwMS13ZWVrLWFuZC15ZWFyLWluLWphdmFzY3JpcHQuaHRtbFxuICpcbiAqIEBwYXJhbSAge09iamVjdH0gYGRhdGVgXG4gKiBAcmV0dXJuIHtOdW1iZXJ9XG4gKi9cbmZ1bmN0aW9uIGdldFdlZWsoZGF0ZSkge1xuICAvLyBSZW1vdmUgdGltZSBjb21wb25lbnRzIG9mIGRhdGVcbiAgdmFyIHRhcmdldFRodXJzZGF5ID0gbmV3IERhdGUoZGF0ZS5nZXRGdWxsWWVhcigpLCBkYXRlLmdldE1vbnRoKCksIGRhdGUuZ2V0RGF0ZSgpKTtcblxuICAvLyBDaGFuZ2UgZGF0ZSB0byBUaHVyc2RheSBzYW1lIHdlZWtcbiAgdGFyZ2V0VGh1cnNkYXkuc2V0RGF0ZSh0YXJnZXRUaHVyc2RheS5nZXREYXRlKCkgLSAoKHRhcmdldFRodXJzZGF5LmdldERheSgpICsgNikgJSA3KSArIDMpO1xuXG4gIC8vIFRha2UgSmFudWFyeSA0dGggYXMgaXQgaXMgYWx3YXlzIGluIHdlZWsgMSAoc2VlIElTTyA4NjAxKVxuICB2YXIgZmlyc3RUaHVyc2RheSA9IG5ldyBEYXRlKHRhcmdldFRodXJzZGF5LmdldEZ1bGxZZWFyKCksIDAsIDQpO1xuXG4gIC8vIENoYW5nZSBkYXRlIHRvIFRodXJzZGF5IHNhbWUgd2Vla1xuICBmaXJzdFRodXJzZGF5LnNldERhdGUoZmlyc3RUaHVyc2RheS5nZXREYXRlKCkgLSAoKGZpcnN0VGh1cnNkYXkuZ2V0RGF5KCkgKyA2KSAlIDcpICsgMyk7XG5cbiAgLy8gQ2hlY2sgaWYgZGF5bGlnaHQtc2F2aW5nLXRpbWUtc3dpdGNoIG9jY3VyZWQgYW5kIGNvcnJlY3QgZm9yIGl0XG4gIHZhciBkcyA9IHRhcmdldFRodXJzZGF5LmdldFRpbWV6b25lT2Zmc2V0KCkgLSBmaXJzdFRodXJzZGF5LmdldFRpbWV6b25lT2Zmc2V0KCk7XG4gIHRhcmdldFRodXJzZGF5LnNldEhvdXJzKHRhcmdldFRodXJzZGF5LmdldEhvdXJzKCkgLSBkcyk7XG5cbiAgLy8gTnVtYmVyIG9mIHdlZWtzIGJldHdlZW4gdGFyZ2V0IFRodXJzZGF5IGFuZCBmaXJzdCBUaHVyc2RheVxuICB2YXIgd2Vla0RpZmYgPSAodGFyZ2V0VGh1cnNkYXkgLSBmaXJzdFRodXJzZGF5KSAvICg4NjQwMDAwMCo3KTtcbiAgcmV0dXJuIDEgKyBNYXRoLmZsb29yKHdlZWtEaWZmKTtcbn1cblxuLyoqXG4gKiBHZXQgSVNPLTg2MDEgbnVtZXJpYyByZXByZXNlbnRhdGlvbiBvZiB0aGUgZGF5IG9mIHRoZSB3ZWVrXG4gKiAxIChmb3IgTW9uZGF5KSB0aHJvdWdoIDcgKGZvciBTdW5kYXkpXG4gKiBcbiAqIEBwYXJhbSAge09iamVjdH0gYGRhdGVgXG4gKiBAcmV0dXJuIHtOdW1iZXJ9XG4gKi9cbmZ1bmN0aW9uIGdldERheU9mV2VlayhkYXRlKSB7XG4gIHZhciBkb3cgPSBkYXRlLmdldERheSgpO1xuICBpZihkb3cgPT09IDApIHtcbiAgICBkb3cgPSA3O1xuICB9XG4gIHJldHVybiBkb3c7XG59XG5cbi8qKlxuICoga2luZC1vZiBzaG9ydGN1dFxuICogQHBhcmFtICB7Kn0gdmFsXG4gKiBAcmV0dXJuIHtTdHJpbmd9XG4gKi9cbmZ1bmN0aW9uIGtpbmRPZih2YWwpIHtcbiAgaWYgKHZhbCA9PT0gbnVsbCkge1xuICAgIHJldHVybiAnbnVsbCc7XG4gIH1cblxuICBpZiAodmFsID09PSB1bmRlZmluZWQpIHtcbiAgICByZXR1cm4gJ3VuZGVmaW5lZCc7XG4gIH1cblxuICBpZiAodHlwZW9mIHZhbCAhPT0gJ29iamVjdCcpIHtcbiAgICByZXR1cm4gdHlwZW9mIHZhbDtcbiAgfVxuXG4gIGlmIChBcnJheS5pc0FycmF5KHZhbCkpIHtcbiAgICByZXR1cm4gJ2FycmF5JztcbiAgfVxuXG4gIHJldHVybiB7fS50b1N0cmluZy5jYWxsKHZhbClcbiAgICAuc2xpY2UoOCwgLTEpLnRvTG93ZXJDYXNlKCk7XG59O1xuXG5cblxuICBpZiAodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKSB7XG4gICAgZGVmaW5lKGRhdGVGb3JtYXQpO1xuICB9IGVsc2UgaWYgKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0Jykge1xuICAgIG1vZHVsZS5leHBvcnRzID0gZGF0ZUZvcm1hdDtcbiAgfSBlbHNlIHtcbiAgICBnbG9iYWwuZGF0ZUZvcm1hdCA9IGRhdGVGb3JtYXQ7XG4gIH1cbn0pKHRoaXMpO1xuIl19
